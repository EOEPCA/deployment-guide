gitlab:
  gitaly:
    persistence:
      storageClass: {{ getenv "STORAGE_CLASS" }}
    replicaCount: 1

  webservice:
    minReplicas: 1
    resources:
      requests:
        cpu: 100m
        memory: 1Gi
      limits:
        cpu: 500m
        memory: 2Gi
    ingress:
      tls:
        secretName: gitlab-tls

  kas:
    replicas: 1  
    ingress:
      tls:
        secretName: kas-tls

  sidekiq:
    minReplicas: 1
    resources:
      requests:
        cpu: 200m
        memory: 1Gi
      limits:
        cpu: 500m
        memory: 2Gi

postgresql:
  global:
    storageClass: {{ getenv "STORAGE_CLASS" }}
  replicas: 1

redis:
  global:
    storageClass: {{ getenv "STORAGE_CLASS" }}

global:
  edition: ce
  hosts:
    domain: {{ getenv "INGRESS_HOST" }}
  ingress:
    configureCertmanager: false
    class: {{ getenv "INGRESS_CLASS" }}
    provider: {{ getenv "INGRESS_CLASS" }}
    tls:
      external: true
    annotations:
      {{- range $key, $value := (datasource "annotations") }}
      {{ $key }}: "{{ $value }}"
      {{- end }}
    kubernetes.io/tls-acme: true
  minio:
    enabled: false
  appConfig:
  {{- if eq (getenv "MLOPS_OIDC_ENABLED") "true" }}
    omniauth:
      enabled: true
      allowSingleSignOn: ["saml", "openid_connect"]
      blockAutoCreatedUsers: false
      providers:
        - secret: openid-connect
  {{- else }}
    omniauth:
      enabled: false
  {{- end }}
    lfs:
      enabled: true
      bucket: gitlab-lfs-storage
      connection:
        secret: object-storage
        key: connection
    artifacts:
      enabled: false
    uploads:
      enabled: false
    packages:
      enabled: false
    backups:
      bucket: gitlab-backup-storage
      tmpBucket: gitlab-tmp-storage

registry:
  enabled: false
  ingress:
    tls:
      secretName: registry-tls

minio:
  ingress:
    tls:
      secretName: minio-tls

certmanager:
  install: false

nginx-ingress:
  enabled: false

nginx-ingress-geo:
  enabled: false

prometheus:
  install: false

gitlab-runner:
  install: false